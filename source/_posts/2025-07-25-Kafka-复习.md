---
title: Kafka 复习
date: 2025-07-25 08:36:00
categories: 记录
tags:
  - Kafka
  - MessageQueue
---
### 什么是Kafka

Apache Kafka是一个分布式流处理平台，最初由LinkedIn开发，后来成为Apache基金会的开源项目。它设计用于处理实时数据流，具有高吞吐量、低延迟和可靠性。

### Kafka的核心概念

- **Producer（生产者）**：发布消息到Kafka的客户端应用程序

- **Consumer（消费者）**：订阅并处理来自Kafka的消息流的客户端应用程序

- **Topic（主题）**：Topic 是 Kafka 中对消息进行逻辑分类的单元。所有发布到 Kafka 集群的消息都必须归属于某一个 Topic。

- **Partition（分区）**：每个主题可以分为多个分区，允许并行处理，提高吞吐量

- **Broker（代理）**：一个独立的 Kafka 服务器实例被称为一个 Broker。多个 Broker 组合在一起构成一个 Kafka 集群。

- **Consumer Group（消费者组）**：一组协同工作的消费者，共同消费主题中的消息

- **Offset（偏移量）**：分区内每条消息的唯一标识符

- **Zookeeper**：管理和协调Kafka broker的服务

### Kafka的特点

- **高吞吐量**：能够处理数百万条消息

- **低延迟**：消息传递的延迟可以控制在毫秒级

- **可扩展性**：可以无缝扩展为处理更多数据

- **持久性**：消息被持久化到磁盘，防止数据丢失

- **容错性**：在节点失败的情况下继续运行

- **高并发**：支持数千个客户端同时读写

- **实时处理**：能够实时处理流数据

### Kafka的应用场景

- **消息队列**：作为传统消息中间件的替代

- **日志收集**：收集分布式系统中的日志

- **流处理**：实时处理数据流

- **事件溯源**：记录状态变更事件

- **活动跟踪**：跟踪用户行为和活动

- **指标监控**：收集和监控运营数据

### 一个服务器只能有一个 Broker 吗？

这是一个关于“理论”与“最佳实践”的问题。

- **从理论上讲：不是。**
你完全可以在一台物理或虚拟服务器上，启动多个不同的 Broker 进程。只要你为每个 Broker 进程配置不同的端口号（例如 9092, 9093, 9094）、不同的 `broker.id` 和不同的数据存储目录，它们就可以在同一台机器上共存。

- **从生产实践上讲：是的，最佳实践是一台服务器只运行一个 Broker 实例。**
为什么呢？
  12. **资源隔离：** Kafka 是一个重度依赖磁盘 I/O 和内存的系统。将一个服务器的全部资源（CPU、内存、磁盘、网络带宽）都分配给一个 Broker 实例，可以避免多个 Broker 实例之间争抢资源，从而获得最稳定和可预测的性能。
  13. **简化运维：** 一台服务器对应一个 Broker，使得监控、管理和故障排查都变得非常简单明了。如果一台服务器上的某个 Broker 出了问题，你立刻就能定位到是哪台机器。
  14. **故障隔离：** 如果一台服务器因为硬件故障宕机了，你只会损失一个 Broker。如果你在一台服务器上运行了三个 Broker，那一次宕机就会同时损失三个 Broker，对集群的冲击更大。

小结：在生产环境中，标准的最佳实践是一台服务器只部署和运行一个 Broker 实例，以确保资源隔离和简化运维。虽然技术上可以在一台服务器上运行多个 Broker，但这是一种不被推荐的做法。
